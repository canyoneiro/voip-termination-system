[Definition]
# Fail2ban filter for SIP scanner detection
# Detects VoIP scanning tools like SIPVicious, sipvicious, friendly-scanner, etc.

failregex = kamailio\[.*\]: .*User-Agent:.*[Ss]ip[Vv]icious.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*friendly-scanner.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*sipcli.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*VaxSIPUserAgent.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*pplsip.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*sundayddr.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*iWar.*<HOST>
            kamailio\[.*\]: .*User-Agent:.*sipsak.*<HOST>
            SCANNER - SIP scanner detected from <HOST>
            SIP Scanner.*<HOST>

ignoreregex =

datepattern = ^%%b %%d %%H:%%M:%%S
              %%Y-%%m-%%d %%H:%%M:%%S
              {^LN-BEG}
