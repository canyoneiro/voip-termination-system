[DEFAULT]
# Email notifications
destemail = david@tellmetelecom.com
sender = fail2ban@sw1.tellmetelecom.com
mta = sendmail
action = %(action_mwl)s

# Default ban settings
bantime = 3600
findtime = 600
maxretry = 5

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200

[kamailio]
enabled = true
filter = kamailio
action = iptables-allports[name=kamailio, protocol=all]
         voip-blacklist[name=kamailio]
logpath = /var/log/syslog
maxretry = 5
findtime = 600
bantime = 3600

[kamailio-aggressive]
enabled = true
filter = kamailio
action = iptables-allports[name=kamailio-aggressive, protocol=all]
         voip-blacklist[name=kamailio-flood]
logpath = /var/log/syslog
maxretry = 20
findtime = 60
bantime = 86400

[kamailio-scanner]
enabled = true
filter = kamailio-scanner
action = iptables-allports[name=kamailio-scanner, protocol=all]
         voip-blacklist[name=kamailio-scanner]
logpath = /var/log/syslog
maxretry = 1
findtime = 3600
bantime = 604800

[nginx-voip-login]
enabled = true
filter = nginx-voip-login
action = iptables-multiport[name=voip-login, port="http,https"]
         voip-blacklist[name=nginx-login]
logpath = /var/log/nginx/access.log
maxretry = 5
findtime = 300
bantime = 1800

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
action = iptables-multiport[name=nginx-botsearch, port="http,https"]
         voip-blacklist[name=nginx-botsearch]
logpath = /var/log/nginx/access.log
maxretry = 2
findtime = 60
bantime = 86400
