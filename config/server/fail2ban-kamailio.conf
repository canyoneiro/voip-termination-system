[Definition]
# Fail2ban filter for Kamailio VoIP system
# Catches various attack patterns logged by Kamailio

failregex = AUTH - Unauthorized IP: <HOST>
            BLACKLIST - Blocked IP.*: <HOST>
            FLOOD - IP <HOST> exceeded
            PIKE - Blocked.*IP:<HOST>
            SECURITY - .*from <HOST>
            ACC: .*src_ip=<HOST>;.*sip_code=403
            ACC: .*src_ip=<HOST>;.*sip_code=401
            ACC: .*src_ip=<HOST>;.*sip_code=407
            PIKE: Blocking source IP: <HOST>
            kamailio\[.*\]: ERROR:.*<HOST>.*failed authentication
            kamailio\[.*\]: WARNING:.*scanner detected.*<HOST>
            kamailio\[.*\]: .*method=REGISTER.*from_ip=<HOST>.*response=403
            kamailio\[.*\]: .*method=INVITE.*from_ip=<HOST>.*response=403
            kamailio\[.*\]: sanity.*<HOST>.*malformed
            kamailio\[.*\]: topoh:.*<HOST>.*suspicious

ignoreregex =

# Date patterns for Kamailio syslog
datepattern = ^%%b %%d %%H:%%M:%%S
              %%Y-%%m-%%d %%H:%%M:%%S
              {^LN-BEG}
